
    <html>
    <head>
        <meta charset="utf-8">
        <style>
            body { font-family: 'Segoe UI', sans-serif; padding: 2em; line-height: 1.6; }
            h1, h2, h3 { color: #222; }
            code { background-color: #f4f4f4; padding: 2px 4px; border-radius: 4px; }
            pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
            table { border-collapse: collapse; width: 100%; margin: 20px 0; }
            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
            a { color: #0366d6; text-decoration: none; }
        </style>
        <title>Writeup</title>
    </head>
    <body>
        <p><a href="http://localhost:8000/html/" style="text-decoration: none;">‚Üê Back</a></p>
<h2>Detecting Lateral Movement and Pass-the-Hash Attacks in Networks</h2>
<p>Lateral movement and Pass-the-Hash (PtH) attacks are key tactics used by attackers after initial compromise to escalate privileges, access sensitive resources, and spread through an environment. Understanding and detecting these behaviors is critical for defending modern enterprise networks.</p>
<h3><strong>2. What is Pass-the-Hash (PtH)?</strong></h3>
<p>Pass-the-Hash is a credential replay attack where an attacker uses stolen hashed credentials (typically NTLM hashes on Windows) to authenticate against other systems without cracking them.</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Extract NTLM hashes from a compromised system (using tools like Mimikatz)</li>
<li>Reuse the hash to authenticate via SMB or RDP on other machines</li>
<li>No need to know the actual password</li>
</ul>
<h3><strong>4. Indicators of Lateral Movement</strong></h3>
<ul>
<li><strong>Logons from unusual sources</strong> (new IPs, user workstations logging onto servers)</li>
<li><strong>Abnormal use of admin tools</strong> (PsExec, WMI, WinRM)</li>
<li><strong>Kerberos ticket anomalies</strong> (unusual ticket-granting behavior)</li>
<li><strong>High volume of SMB traffic</strong></li>
<li><strong>Execution of remote commands</strong></li>
</ul>
<h3><strong>6. Defense and Mitigation</strong></h3>
<ul>
<li><strong>Enforce least privilege</strong>: Limit lateral movement by restricting admin access.</li>
<li><strong>Credential hygiene</strong>: Avoid credential reuse, disable legacy protocols like NTLM.</li>
<li><strong>Enable Credential Guard</strong>: Protect LSASS memory in Windows.</li>
<li><strong>Segment the network</strong>: Isolate systems to limit movement scope.</li>
<li><strong>Log and alert</strong> on suspicious authentication and remote execution behavior.</li>
<li><strong>Patch regularly</strong>: Prevent attackers from exploiting known vulnerabilities for pivoting.</li>
</ul>
<h3><strong>Conclusion</strong></h3>
<p>Detecting lateral movement and Pass-the-Hash attacks requires a combination of strong logging, behavioral analysis, privilege control, and proactive threat hunting. Incorporating these detections into your security posture significantly increases your ability to stop an attacker before they reach critical assets.</p>
    </body>
    </html>
    